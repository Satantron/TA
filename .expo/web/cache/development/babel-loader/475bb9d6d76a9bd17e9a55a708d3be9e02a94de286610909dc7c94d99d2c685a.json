{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar BOOKMARKS_KEY = 'lorebrary:bookmarks';\nvar BookmarksContext = createContext(null);\nexport function BookmarksProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    bookmarks = _useState2[0],\n    setBookmarks = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loaded = _useState4[0],\n    setLoaded = _useState4[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      try {\n        var raw = yield AsyncStorage.getItem(BOOKMARKS_KEY);\n        if (raw) {\n          var parsed = JSON.parse(raw);\n          var normalized = (Array.isArray(parsed) ? parsed : []).map(function (b) {\n            return _objectSpread(_objectSpread({}, b), {}, {\n              unread: b.unread === undefined ? false : b.unread\n            });\n          });\n          setBookmarks(normalized);\n        }\n      } catch (e) {\n        console.warn('Failed to load bookmarks', (e == null ? void 0 : e.message) || e);\n      } finally {\n        setLoaded(true);\n      }\n    })();\n  }, []);\n  useEffect(function () {\n    if (!loaded) return;\n    _asyncToGenerator(function* () {\n      try {\n        yield AsyncStorage.setItem(BOOKMARKS_KEY, JSON.stringify(bookmarks));\n      } catch (e) {\n        console.warn('Failed to save bookmarks', (e == null ? void 0 : e.message) || e);\n      }\n    })();\n  }, [bookmarks, loaded]);\n  function addBookmark(item) {\n    setBookmarks(function (prev) {\n      if (prev.find(function (b) {\n        return b.id === item.id;\n      })) return prev;\n      var toAdd = _objectSpread(_objectSpread({}, item), {}, {\n        unread: true\n      });\n      return [toAdd].concat(_toConsumableArray(prev));\n    });\n  }\n  function removeBookmark(id) {\n    setBookmarks(function (prev) {\n      return prev.filter(function (b) {\n        return b.id !== id;\n      });\n    });\n  }\n  function markAllSeen() {\n    setBookmarks(function (prev) {\n      return prev.map(function (b) {\n        return b.unread ? _objectSpread(_objectSpread({}, b), {}, {\n          unread: false\n        }) : b;\n      });\n    });\n  }\n  function markSeen(id) {\n    setBookmarks(function (prev) {\n      return prev.map(function (b) {\n        return b.id === id && b.unread ? _objectSpread(_objectSpread({}, b), {}, {\n          unread: false\n        }) : b;\n      });\n    });\n  }\n  var value = {\n    bookmarks: bookmarks,\n    addBookmark: addBookmark,\n    removeBookmark: removeBookmark,\n    markAllSeen: markAllSeen,\n    markSeen: markSeen,\n    loaded: loaded\n  };\n  return _jsx(BookmarksContext.Provider, {\n    value: value,\n    children: children\n  });\n}\nexport function useBookmarks() {\n  var ctx = useContext(BookmarksContext);\n  if (!ctx) throw new Error('useBookmarks must be used within BookmarksProvider');\n  return ctx;\n}\nexport default BookmarksContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","AsyncStorage","jsx","_jsx","BOOKMARKS_KEY","BookmarksContext","BookmarksProvider","_ref","children","_useState","_useState2","_slicedToArray","bookmarks","setBookmarks","_useState3","_useState4","loaded","setLoaded","_asyncToGenerator","raw","getItem","parsed","JSON","parse","normalized","Array","isArray","map","b","_objectSpread","unread","undefined","e","console","warn","message","setItem","stringify","addBookmark","item","prev","find","id","toAdd","concat","_toConsumableArray","removeBookmark","filter","markAllSeen","markSeen","value","Provider","useBookmarks","ctx","Error"],"sources":["C:/SoftEng/VScode/Javascript/TA/context/BookmarksContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst BOOKMARKS_KEY = 'lorebrary:bookmarks';\r\nconst BookmarksContext = createContext(null);\r\n\r\nexport function BookmarksProvider({ children }) {\r\n  const [bookmarks, setBookmarks] = useState([]);\r\n  const [loaded, setLoaded] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const raw = await AsyncStorage.getItem(BOOKMARKS_KEY);\r\n        if (raw) {\r\n          // normalize older entries to include `unread` flag\r\n          const parsed = JSON.parse(raw);\r\n          const normalized = (Array.isArray(parsed) ? parsed : []).map(b => ({ ...b, unread: b.unread === undefined ? false : b.unread }));\r\n          setBookmarks(normalized);\r\n        }\r\n      } catch (e) {\r\n        console.warn('Failed to load bookmarks', e?.message || e);\r\n      } finally {\r\n        setLoaded(true);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!loaded) return;\r\n    (async () => {\r\n      try {\r\n        await AsyncStorage.setItem(BOOKMARKS_KEY, JSON.stringify(bookmarks));\r\n      } catch (e) {\r\n        console.warn('Failed to save bookmarks', e?.message || e);\r\n      }\r\n    })();\r\n  }, [bookmarks, loaded]);\r\n\r\n  function addBookmark(item) {\r\n    setBookmarks(prev => {\r\n      if (prev.find(b => b.id === item.id)) return prev;\r\n      // mark new bookmarks as unread\r\n      const toAdd = { ...item, unread: true };\r\n      return [toAdd, ...prev];\r\n    });\r\n  }\r\n\r\n  function removeBookmark(id) {\r\n    setBookmarks(prev => prev.filter(b => b.id !== id));\r\n  }\r\n\r\n  function markAllSeen() {\r\n    setBookmarks(prev => prev.map(b => (b.unread ? { ...b, unread: false } : b)));\r\n  }\r\n\r\n  function markSeen(id) {\r\n    setBookmarks(prev => prev.map(b => (b.id === id && b.unread ? { ...b, unread: false } : b)));\r\n  }\r\n\r\n  const value = { bookmarks, addBookmark, removeBookmark, markAllSeen, markSeen, loaded };\r\n  return <BookmarksContext.Provider value={value}>{children}</BookmarksContext.Provider>;\r\n}\r\n\r\nexport function useBookmarks() {\r\n  const ctx = useContext(BookmarksContext);\r\n  if (!ctx) throw new Error('useBookmarks must be used within BookmarksProvider');\r\n  return ctx;\r\n}\r\n\r\nexport default BookmarksContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}