{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createClient } from '@supabase/supabase-js';\nvar SUPABASE_URL = process.env.SUPABASE_URL;\nvar SUPABASE_ANON_KEY = process.env.SUPABASE_ANON_KEY;\ntry {\n  var Constants = require('expo-constants').default;\n  var extra = Constants.manifest && Constants.manifest.extra || Constants.expoConfig && Constants.expoConfig.extra;\n  if (extra) {\n    SUPABASE_URL = SUPABASE_URL || extra.SUPABASE_URL;\n    SUPABASE_ANON_KEY = SUPABASE_ANON_KEY || extra.SUPABASE_ANON_KEY;\n  }\n} catch (e) {}\nSUPABASE_URL = SUPABASE_URL || 'https://your-project.supabase.co';\nSUPABASE_ANON_KEY = SUPABASE_ANON_KEY || 'PUBLIC_ANON_KEY';\nexport var supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);\nexport function fetchMyths() {\n  return _fetchMyths.apply(this, arguments);\n}\nfunction _fetchMyths() {\n  _fetchMyths = _asyncToGenerator(function* () {\n    try {\n      var _yield$supabase$from$ = yield supabase.from('myths').select('*').order('id', {\n          ascending: true\n        }),\n        data = _yield$supabase$from$.data,\n        error = _yield$supabase$from$.error;\n      if (error) throw error;\n      return data;\n    } catch (err) {\n      console.warn('Supabase fetch failed, falling back to local seed', (err == null ? void 0 : err.message) || err);\n      return null;\n    }\n  });\n  return _fetchMyths.apply(this, arguments);\n}\nexport function fetchMythsPage() {\n  return _fetchMythsPage.apply(this, arguments);\n}\nfunction _fetchMythsPage() {\n  _fetchMythsPage = _asyncToGenerator(function* () {\n    var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    var pageSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n    var start = (page - 1) * pageSize;\n    var end = start + pageSize - 1;\n    try {\n      var _yield$supabase$from$2 = yield supabase.from('myths').select('*', {\n          count: 'exact'\n        }).order('id', {\n          ascending: true\n        }).range(start, end),\n        data = _yield$supabase$from$2.data,\n        error = _yield$supabase$from$2.error,\n        count = _yield$supabase$from$2.count;\n      if (error) throw error;\n      return {\n        data: data || [],\n        total: typeof count === 'number' ? count : data ? data.length : 0\n      };\n    } catch (err) {\n      console.warn('Supabase paged fetch failed', (err == null ? void 0 : err.message) || err);\n      return null;\n    }\n  });\n  return _fetchMythsPage.apply(this, arguments);\n}\nexport function testSupabaseConnection() {\n  return _testSupabaseConnection.apply(this, arguments);\n}\nfunction _testSupabaseConnection() {\n  _testSupabaseConnection = _asyncToGenerator(function* () {\n    try {\n      var _yield$supabase$from$3 = yield supabase.from('myths').select('id').limit(1),\n        data = _yield$supabase$from$3.data,\n        error = _yield$supabase$from$3.error;\n      if (error) {\n        console.warn('Supabase test query error:', error.message || error);\n        return false;\n      }\n      return Array.isArray(data);\n    } catch (err) {\n      console.warn('Supabase test failed:', (err == null ? void 0 : err.message) || err);\n      return false;\n    }\n  });\n  return _testSupabaseConnection.apply(this, arguments);\n}","map":{"version":3,"names":["createClient","SUPABASE_URL","process","env","SUPABASE_ANON_KEY","Constants","require","default","extra","manifest","expoConfig","e","supabase","fetchMyths","_fetchMyths","apply","arguments","_asyncToGenerator","_yield$supabase$from$","from","select","order","ascending","data","error","err","console","warn","message","fetchMythsPage","_fetchMythsPage","page","length","undefined","pageSize","start","end","_yield$supabase$from$2","count","range","total","testSupabaseConnection","_testSupabaseConnection","_yield$supabase$from$3","limit","Array","isArray"],"sources":["C:/SoftEng/VScode/Javascript/TA/supabase.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\n// Determine Supabase credentials from multiple sources so the project works\r\n// both in a plain Node environment and in Expo (via app.json `expo.extra`).\r\nlet SUPABASE_URL = process.env.SUPABASE_URL;\r\nlet SUPABASE_ANON_KEY = process.env.SUPABASE_ANON_KEY;\r\n\r\n// If running inside Expo, read values from Constants.manifest.extra when available.\r\ntry {\r\n  // require here so file can still run in non-Expo environments\r\n  // (Metro will provide expo-constants in Expo projects).\r\n  // eslint-disable-next-line global-require\r\n  const Constants = require('expo-constants').default;\r\n  const extra = (Constants.manifest && Constants.manifest.extra) || (Constants.expoConfig && Constants.expoConfig.extra);\r\n  if (extra) {\r\n    SUPABASE_URL = SUPABASE_URL || extra.SUPABASE_URL;\r\n    SUPABASE_ANON_KEY = SUPABASE_ANON_KEY || extra.SUPABASE_ANON_KEY;\r\n  }\r\n} catch (e) {\r\n  // Not running under Expo or expo-constants not installed â€” ignore.\r\n}\r\n\r\n// Fallback placeholders (do NOT commit real keys to the repo)\r\nSUPABASE_URL = SUPABASE_URL || 'https://your-project.supabase.co';\r\nSUPABASE_ANON_KEY = SUPABASE_ANON_KEY || 'PUBLIC_ANON_KEY';\r\n\r\nexport const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);\r\n\r\nexport async function fetchMyths() {\r\n  try {\r\n    const { data, error } = await supabase.from('myths').select('*').order('id', { ascending: true });\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (err) {\r\n    console.warn('Supabase fetch failed, falling back to local seed', err?.message || err);\r\n    return null;\r\n  }\r\n}\r\n\r\n// Fetch a page of myths from Supabase using range and request exact count.\r\n// Returns { data: [...], total: number } on success, or null on failure.\r\nexport async function fetchMythsPage(page = 1, pageSize = 10) {\r\n  const start = (page - 1) * pageSize;\r\n  const end = start + pageSize - 1;\r\n  try {\r\n    const { data, error, count } = await supabase\r\n      .from('myths')\r\n      .select('*', { count: 'exact' })\r\n      .order('id', { ascending: true })\r\n      .range(start, end);\r\n    if (error) throw error;\r\n    return { data: data || [], total: typeof count === 'number' ? count : (data ? data.length : 0) };\r\n  } catch (err) {\r\n    console.warn('Supabase paged fetch failed', err?.message || err);\r\n    return null;\r\n  }\r\n}\r\n\r\n// Optional helper to test the Supabase connection; returns true when successful.\r\nexport async function testSupabaseConnection() {\r\n  try {\r\n    const { data, error } = await supabase.from('myths').select('id').limit(1);\r\n    if (error) {\r\n      console.warn('Supabase test query error:', error.message || error);\r\n      return false;\r\n    }\r\n    return Array.isArray(data);\r\n  } catch (err) {\r\n    console.warn('Supabase test failed:', err?.message || err);\r\n    return false;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}